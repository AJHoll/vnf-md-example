# Быстрый старт

## Клонирование репозитария

Для просмотра вам понадоибтся репозитарий - скачайте его удобным для вас способом, если у вас установлен Git, то действие выполняется простым скриптом

```bash
git clone https://github.com/AJHoll/vnf-md-example.git
```

## Разворачивание базы

Для разворачивания базы вам понадобится установленный PostgresPro версии 12 или выше.
Дамп создан на версии 12.5 и точно работает на нем.

Проверить можно, выполнив простой скрипт:

```bash
@ psql --version

# ответ: psql (PostgreSQL) 12.5
```

Если у вас его нет - то пройдя по ссылке можно скачать с официального сайта компании Postgres Professional.

[https://www.postgrespro.ru/#order](https://www.postgrespro.ru/#order)

Есть вероятность, что развернется и на более ранних версиях Postgres, но данный момент не проверялся.

Первое, что следует сделать - это выполнить на кластере файл со скриптом **_before_restore.sql_**

Он создаст в базе две роли для дальнейшей работы базы:

- uni_user
- uni_admin

Далее, вам следует воспользоваться файлом **_restore.cmd_**

Для правильного развертывания требуется изменить следующие переменные:

- **file_path** - путь к файлу с дампом (по-умолчанию он заберет файл #000_last_dump.tar из директории ./dumps)
- **host** - хост вашего кластера PostgresPro (по-умолчанию localhost)
- **port** - порт вашего кластера PostgresPro (по-умолчанию 5432)
- **username** - пользователь из под кого будет установлена разворачиваемая база

```bat
@echo off

set file_path=./dumps
set host=127.0.0.1
set port=5432
set username=sys

pg_restore -v -c -C -h %host% -p %port% -U %username% -W -d postgres %file_path%\#000_last_dump.tar
```

После изменения файла **_restore.cmd_** его следует запустить - ввести в консоли пароль и подождать, пока psql развернет базу.

По завершению его работы в кластере появится база с наименованием **_vnf-md-db_**

База построена в соответствии стандарту uni_dev_standart.

Для понимания стандарта, его можно посмотреть в корне данного репозитария.
Файл **dev_uni_standart.doc**

## Запуск REST API

В любом из нижеописанных случаев вам понадобиться скачать node js.

Скачать ее можно с официального сайта node js

[https://nodejs.org/ru/](https://nodejs.org/ru/)

### Запуск из релиза

Для запуска API вам понадобится

Зайдите в папку **./rest-api/releases/**
В ней найдите файл \*.tgz с последней версией REST API

После чего распакуйте ее в удобное для вас место.
Для запуска сервера требуется изменить ряд переменных среды, для чего ищем в каталоге, в который вы распаковали API файл **_.env_**

Он содержит в себе ряд переменных:

- **DB_HOST** - Хост вашего кластера PostgresPro
- **DB_PORT** - Порт вашего кластера PostgresPro
- **DB_USER** - Имя пользователя кластера PostgresPro
- **DB_PASS** - Пароль пользователя кластера PostgresPro
- **DB_DATABASE** - База данных
- **REST_PORT** - Порт, на котором запускается REST API

```ts
DB_HOST = "localhost";
DB_PORT = 5432;
DB_USER = "";
DB_PASS = "";
DB_DATABASE = "vnf-md-db";
REST_PORT = 8080;
```

выполните команду

```bash
@ node main
```

В ответ в консоли должен запуститься и поддерживаться сервер

### Запуск из проекта

Перед дальнейшими действиями устанавливаем `yarn`

```bash
@ npm i -g yarn
```

Для успешного запуска вам потребуется зайти в папку ./rest-api/

Создать в этой папке файл **_.env_**, после чего заполнить его, как было показано выше.

После чего выполняем в этой папке команду

```bash
@ yarn
```

В проект загрузятся необходимые node_modules.

После успешной установки модулей - выполните команду

```bash
@ yarn start
```

Если все сделано верно, в консоли выведется зеленые надписи о подключенных REST API controller и далее можно будет пользоваться REST API.

## Развертывание тонкого клиента

Для развертывания на понадобится nginx, скачать его так же можно на официальном сайте nginx

Распаковываем его в любое удобное место.

Далее в папку с nginx копируем содержимое папки ./thin-client/release

Запускаем nginx.exe

При переходе на адрес localhost:8888 (если вы не меняли ничего в nginx.conf) появится тонкий клиент master-detail
